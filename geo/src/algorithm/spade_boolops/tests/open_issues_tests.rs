use crate::SpadeBoolops;
use geo_types::{Coord, LineString, MultiPolygon, Polygon};
use wkt::TryFromWkt;

#[test]
fn no_1103_union_for_f32_polys() {
    let polygons = [
        Polygon::<f32>::new(
            LineString::from(vec![
                Coord {
                    x: 3.349_365_2,
                    y: -55.801_27,
                },
                Coord {
                    x: 171.224_43,
                    y: -300.0,
                },
                Coord {
                    x: 291.841_64,
                    y: -300.0,
                },
                Coord {
                    x: 46.650_635,
                    y: -30.801_27,
                },
                Coord {
                    x: 3.349_365_2,
                    y: -55.801_27,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f32>::new(
            LineString::from(vec![
                Coord {
                    x: 46.650_635,
                    y: -30.801_27,
                },
                Coord {
                    x: 291.841_64,
                    y: -300.0,
                },
                Coord {
                    x: 300.0,
                    y: -228.340_03,
                },
                Coord {
                    x: -3.349_365_2,
                    y: 55.801_27,
                },
                Coord {
                    x: 46.650_635,
                    y: -30.801_27,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f32>::new(
            LineString::from(vec![
                Coord {
                    x: -46.650_635,
                    y: 30.801_27,
                },
                Coord {
                    x: 195.837_28,
                    y: -300.0,
                },
                Coord {
                    x: 300.0,
                    y: -228.340_03,
                },
                Coord {
                    x: -3.349_365_2,
                    y: 55.801_27,
                },
                Coord {
                    x: -46.650_635,
                    y: 30.801_27,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f32>::new(
            LineString::from(vec![
                Coord {
                    x: 3.349_365_2,
                    y: -55.801_27,
                },
                Coord {
                    x: 171.224_43,
                    y: -300.0,
                },
                Coord {
                    x: 195.837_28,
                    y: -300.0,
                },
                Coord {
                    x: -46.650_635,
                    y: 30.801_27,
                },
                Coord {
                    x: 3.349_365_2,
                    y: -55.801_27,
                },
            ]),
            Vec::new(),
        ),
    ];

    let mut multi = MultiPolygon::new(Vec::new());
    for poly in polygons {
        multi = MultiPolygon::union(&multi, &MultiPolygon::new(vec![poly])).unwrap();
    }
}

#[test]
fn no_1103_union_for_f64_polys() {
    let polygons = [
        Polygon::<f64>::new(
            LineString::from(vec![
                Coord {
                    x: 3.349365234375,
                    y: -55.80126953125,
                },
                Coord {
                    x: 171.224_426_269_531_25,
                    y: -300.0,
                },
                Coord {
                    x: 291.841_644_287_109_4,
                    y: -300.0,
                },
                Coord {
                    x: 46.650_634_765_625,
                    y: -30.801_269_531_25,
                },
                Coord {
                    x: 3.349_365_234_375,
                    y: -55.801_269_531_25,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f64>::new(
            LineString::from(vec![
                Coord {
                    x: 46.650_634_765_625,
                    y: -30.801_269_531_25,
                },
                Coord {
                    x: 291.841_644_287_109_4,
                    y: -300.0,
                },
                Coord {
                    x: 300.0,
                    y: -228.340_026_855_468_75,
                },
                Coord {
                    x: -3.349_365_234_375,
                    y: 55.801_269_531_25,
                },
                Coord {
                    x: 46.650_634_765_625,
                    y: -30.801_269_531_25,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f64>::new(
            LineString::from(vec![
                Coord {
                    x: -46.650_634_765_625,
                    y: 30.801_269_531_25,
                },
                Coord {
                    x: 195.837_280_273_437_5,
                    y: -300.0,
                },
                Coord {
                    x: 300.0,
                    y: -228.340_026_855_468_75,
                },
                Coord {
                    x: -3.349_365_234_375,
                    y: 55.801_269_531_25,
                },
                Coord {
                    x: -46.650_634_765_625,
                    y: 30.801_269_531_25,
                },
            ]),
            Vec::new(),
        ),
        Polygon::<f64>::new(
            LineString::from(vec![
                Coord {
                    x: 3.349_365_234_375,
                    y: -55.801_269_531_25,
                },
                Coord {
                    x: 171.224_426_269_531_25,
                    y: -300.0,
                },
                Coord {
                    x: 195.837_280_273_437_5,
                    y: -300.0,
                },
                Coord {
                    x: -46.650_634_765_625,
                    y: 30.801_269_531_25,
                },
                Coord {
                    x: 3.349_365_234_375,
                    y: -55.801_269_531_25,
                },
            ]),
            Vec::new(),
        ),
    ];

    let mut multi = MultiPolygon::new(Vec::new());
    for poly in polygons {
        multi = MultiPolygon::union(&multi, &MultiPolygon::new(vec![poly])).unwrap();
    }
}

#[test]
fn no_1053_intersection_for_f32_polys() {
    // Reproduction occurs when intersecting Polygon<f32> types, but Polygon<f64> does not reproduce.
    let geo1 = Polygon::<f32>::new(
        LineString(vec![
            Coord { x: 0.0, y: 0.0 },
            Coord { x: 0.0, y: 200.0 },
            Coord { x: 200.0, y: 200.0 },
            Coord { x: 200.0, y: 0.0 },
            Coord { x: 0.0, y: 0.0 },
        ]),
        vec![],
    );
    let geo2 = Polygon::<f32>::new(
        LineString(vec![
            Coord {
                x: -0.17588139,
                y: 0.0015348792,
            },
            Coord {
                x: 1.5845897,
                y: 201.73154,
            },
            Coord {
                x: 200.1759,
                y: 199.99846,
            },
            Coord {
                x: 198.41544,
                y: -1.7315454,
            },
            Coord {
                x: -0.17588139,
                y: 0.0015348792,
            },
        ]),
        vec![],
    );
    let _valid_result = Polygon::intersection(&geo1, &geo2).unwrap();
}

#[test]
fn no_1064_intersection_for_f64() {
    let a: Polygon = Polygon::try_from_wkt_str("POLYGON ((709799.9999999999 4535330.115932672, 709800.0000000001 4535889.8772568945, 709800.0057476197 4535889.994252375, 709800.1227431173 4535890.000000001, 710109.8788852151 4535889.999999996, 710109.994510683 4535889.99439513, 710110.0025226776 4535889.878911494, 710119.9974094903 4535410.124344491, 710119.9939843 4535410.005891683, 710119.8756285358 4535410.000000003, 710050.1240139506 4535410.000000003, 710050.0040320279 4535410.005955433, 710049.9539423736 4535410.115144073, 710038.1683017325 4535439.579245671, 710037.9601922985 4535440.0325333765, 710037.7079566419 4535440.462831489, 710037.4141048047 4535440.865858022, 710037.0815609565 4535441.237602393, 710036.7136342974 4535441.57436531, 710036.3139861295 4535441.872795589, 710035.8865934211 4535442.129923492, 710035.4357092284 4535442.343190307, 710034.9658203793 4535442.510473766, 710034.4816028172 4535442.6301092245, 710033.9878750739 4535442.7009061435, 710033.489550319 4535442.722160025, 710032.9915874689 4535442.6936593605, 710032.4989418354 4535442.615687774, 710032.016515821 4535442.48902117, 710031.54911013 4535442.314920021, 710031.1013759954 4535442.095116852, 710030.6777688961 4535441.831798956, 710030.2825042206 4535441.527586658, 710029.9195153153 4535441.185507218, 710029.5924143443 4535440.808964732, 710029.3044563448 4535440.401706239, 710029.0585068383 4535439.967784446, 710028.8570133082 4535439.511517367, 710028.701980853 4535439.037445406, 710028.5949522265 4535438.550286128, 710028.536992489 4535438.05488734, 710020.008429941 4535310.126449097, 710019.9938185212 4535310.0024022255, 710019.9208325277 4535309.901040657, 709980.0772727348 4535260.096590921, 709979.9987806884 4535260.007853539, 709979.8970781134 4535260.068614591, 709920.1022372885 4535299.931841814, 709920.0058878824 4535300.003151096, 709920.0000000001 4535300.122873942, 709920.0000000002 4535324.451138855, 709919.9762868701 4535324.937522437, 709919.9053724057 4535325.419292543, 709919.7879292492 4535325.891879465, 709919.6250713767 4535326.350800604, 709919.4183435373 4535326.7917029755, 709919.1697065973 4535327.210404501, 709918.8815189389 4535327.602933702, 709918.5565140966 4535327.965567328, 709918.1977748218 4535328.294865718, 709917.8087038476 4535328.5877053905, 709917.3929916087 4535328.841308688, 709916.9545812428 4535329.053270123, 709916.497631181 4535329.221579175, 709916.0264757108 4535329.344639407, 709915.5455838591 4535329.421283546, 709915.059517008 4535329.450784619, 709914.5728856224 4535329.43286279, 709914.0903055237 4535329.367688051, 709913.6163541072 4535329.255878603, 709913.1555269207 4535329.098494996, 709912.7121950255 4535328.89703004, 709912.2905635366 4535328.653394689, 709911.8946317348 4535328.369899881, 709911.5281551343 4535328.049234638, 709911.1946098561 4535327.694440548, 709910.8971596619 4535327.308882924, 709910.638625942 4535326.896218885, 709910.4214609532 4535326.460362643, 709910.2477245614 4535326.005448406, 709910.119064699 4535325.53579115, 709900.0266965557 4535280.120134492, 709899.9954816136 4535280.006411615, 709899.8778852832 4535280.015264336, 709820.1219250998 4535289.984759362, 709820.0038570677 4535290.005451573, 709819.9450491015 4535290.109901799, 709800.0518466672 4535329.896306664, 709800.0053207672 4535330.001256061, 709799.9999999999 4535330.115932672))").unwrap();
    let b: Polygon = Polygon::try_from_wkt_str("POLYGON ((709800 4600020, 809759.9999999993 4600020, 809759.9999999987 4500000, 709800.0000000003 4500000, 709800 4590240, 709800 4600020))").unwrap();

    Polygon::intersection(&a, &b).unwrap();
}

#[test]
fn no_913_intersection_and_difference_for_f32() {
    let p1: MultiPolygon<f32> = MultiPolygon::new(vec![Polygon::new(
        LineString::from(vec![
            Coord {
                x: 140.50,
                y: 62.24,
            },
            Coord {
                x: 140.07,
                y: 62.34,
            },
            Coord {
                x: 136.94,
                y: 63.05,
            },
            Coord {
                x: 140.50,
                y: 62.24,
            },
        ]),
        vec![],
    )]);
    let p2: MultiPolygon<f32> = MultiPolygon::new(vec![Polygon::new(
        LineString::from(vec![
            Coord {
                x: 142.50,
                y: 61.44,
            },
            Coord {
                x: 142.06,
                y: 61.55,
            },
            Coord {
                x: 140.07,
                y: 62.34,
            },
            Coord {
                x: 142.50,
                y: 61.44,
            },
        ]),
        vec![],
    )]);

    let intersection = MultiPolygon::intersection(&p1, &p2).unwrap();
    let _valid_result = MultiPolygon::difference(&p1, &intersection).unwrap();
}

#[test]
fn no_913_union_for_f64() {
    let pg1 = Polygon::new(
        LineString(vec![
            Coord {
                x: 367.679,
                y: 302.785,
            },
            Coord {
                x: 146.985,
                y: 90.13,
            },
            Coord {
                x: 235.63,
                y: 197.771,
            },
            Coord {
                x: 222.764,
                y: 233.747,
            },
            Coord {
                x: 200.38180602615253,
                y: 288.3378373783007,
            },
            Coord {
                x: 207.575,
                y: 288.205,
            },
            Coord {
                x: 367.679,
                y: 302.785,
            },
        ]),
        vec![],
    );

    let pg2 = Polygon::new(
        LineString(vec![
            Coord {
                x: 367.679,
                y: 302.785,
            },
            Coord {
                x: 203.351,
                y: 279.952,
            },
            Coord {
                x: 200.373,
                y: 288.338,
            },
            Coord {
                x: 206.73187706275607,
                y: 288.2205700292493,
            },
            Coord {
                x: 208.489,
                y: 286.233,
            },
            Coord {
                x: 212.24,
                y: 285.478,
            },
            Coord {
                x: 367.679,
                y: 302.785,
            },
        ]),
        vec![],
    );

    let _valid_result = Polygon::union(&pg1, &pg2).unwrap();
}

#[test]
fn no_913_big_union_for_f64() {
    let pg1 = Polygon::new(
        LineString(vec![
            Coord {
                x: 0.0,
                y: 243.4003107156999,
            },
            Coord {
                x: 66.27444465680952,
                y: 250.87823764635957,
            },
            Coord {
                x: 96.33638429757961,
                y: 248.20750628598208,
            },
            Coord {
                x: 96.52875443322587,
                y: 236.0960826183176,
            },
            Coord {
                x: 109.01797296466019,
                y: 237.22982767630356,
            },
            Coord {
                x: 110.67808356405288,
                y: 222.36101161840142,
            },
            Coord {
                x: 177.32511967843928,
                y: 245.4303896678587,
            },
            Coord {
                x: 220.03681983758034,
                y: 231.22020737406902,
            },
            Coord {
                x: 220.26051686053162,
                y: 230.70916392688252,
            },
            Coord {
                x: 222.76475236003864,
                y: 233.7471699986308,
            },
            Coord {
                x: 235.63037504441513,
                y: 197.77142864845837,
            },
            Coord {
                x: 46.120740248112526,
                y: 194.2466054578009,
            },
            Coord {
                x: 0.0,
                y: 197.3285470235943,
            },
            Coord {
                x: 1.6250409484162764e-15,
                y: 195.62006213211825,
            },
            Coord {
                x: 0.0,
                y: 195.62006213211825,
            },
            Coord {
                x: 0.0,
                y: 166.11923271453853,
            },
            Coord {
                x: 84.46350148899029,
                y: 172.13043318345098,
            },
            Coord {
                x: 85.18497315136065,
                y: 135.51645414474072,
            },
            Coord {
                x: 113.74634762902987,
                y: 143.6756896905261,
            },
            Coord {
                x: 120.613520578221,
                y: 116.4384347293961,
            },
            Coord {
                x: 120.61352057822103,
                y: 116.43843472939612,
            },
            Coord {
                x: 120.95625623486023,
                y: 115.07904294864129,
            },
            Coord {
                x: 133.11594113032265,
                y: 121.5727268145846,
            },
            Coord {
                x: 136.76528203129863,
                y: 99.7945926414018,
            },
            Coord {
                x: 136.76528203129865,
                y: 99.79459264140182,
            },
            Coord {
                x: 136.95169923472406,
                y: 98.68211261321306,
            },
            Coord {
                x: 142.86571296028092,
                y: 103.2131667249273,
            },
            Coord {
                x: 146.98556814305613,
                y: 90.1306295921712,
            },
            Coord {
                x: 149.81840786246337,
                y: 87.34720718892197,
            },
            Coord {
                x: 149.8184078624634,
                y: 87.34720718892198,
            },
            Coord {
                x: 157.36666554726634,
                y: 79.93062466875924,
            },
            Coord {
                x: 184.82983774975878,
                y: 111.82526107380869,
            },
            Coord {
                x: 211.8877775129764,
                y: 95.80693442569219,
            },
            Coord {
                x: 227.5571963507852,
                y: 98.78793110381741,
            },
            Coord {
                x: 218.607932670586,
                y: 55.083930748810644,
            },
            Coord {
                x: 221.83929458508348,
                y: 52.149586224826386,
            },
            Coord {
                x: 221.83929458508348,
                y: 52.14958622482635,
            },
            Coord {
                x: 232.98401357993802,
                y: 42.029257391594996,
            },
            Coord {
                x: 241.8190745801098,
                y: 13.993506274058689,
            },
            Coord {
                x: 241.1380006507843,
                y: 0.0,
            },
            Coord {
                x: 241.60061958968532,
                y: 2.044378041651483e-14,
            },
            Coord {
                x: 241.60061958968532,
                y: -2.842170943040401e-14,
            },
            Coord {
                x: 249.98742446013085,
                y: -2.842170943040401e-14,
            },
            Coord {
                x: 249.98742446013085,
                y: 1.85917124373295e-14,
            },
            Coord {
                x: 254.4202314064203,
                y: 2.842170943040401e-14,
            },
            Coord {
                x: 247.73005601682144,
                y: 120.74050514867251,
            },
            Coord {
                x: 259.2004570591687,
                y: 144.14650678216447,
            },
            Coord {
                x: 266.8397653781389,
                y: 154.40474480753,
            },
            Coord {
                x: 296.8607072090515,
                y: 129.49256607782735,
            },
            Coord {
                x: 352.116978342238,
                y: 128.0069901264593,
            },
            Coord {
                x: 375.0780451860593,
                y: 94.15446213853835,
            },
            Coord {
                x: 374.98659859747573,
                y: 100.58888400844128,
            },
            Coord {
                x: 375.530089594595,
                y: 124.2204839556052,
            },
            Coord {
                x: 400.0,
                y: 94.35082668552377,
            },
            Coord {
                x: 400.0,
                y: 101.6071057208606,
            },
            Coord {
                x: 400.0,
                y: 105.80164716197932,
            },
            Coord {
                x: 400.0,
                y: 113.6261499931943,
            },
            Coord {
                x: 400.0,
                y: 311.5380102022039,
            },
            Coord {
                x: 400.0,
                y: 318.2032485086692,
            },
            Coord {
                x: 400.0,
                y: 334.71250969254965,
            },
            Coord {
                x: 400.0,
                y: 352.42377480851513,
            },
            Coord {
                x: 367.67936762793977,
                y: 302.785219017324,
            },
            Coord {
                x: 243.8528456455854,
                y: 299.9323675588228,
            },
            Coord {
                x: 221.67982343202226,
                y: 315.355350903515,
            },
            Coord {
                x: 221.61838827018173,
                y: 313.1570930513446,
            },
            Coord {
                x: 217.6731029946546,
                y: 302.77563506887896,
            },
            Coord {
                x: 213.10441329274047,
                y: 314.6831957928891,
            },
            Coord {
                x: 212.0282774321647,
                y: 314.64026940589486,
            },
            Coord {
                x: 212.02827743216469,
                y: 314.64026940589486,
            },
            Coord {
                x: 195.75881007955047,
                y: 313.99129052009226,
            },
            Coord {
                x: 195.7588100795505,
                y: 313.99129052009226,
            },
            Coord {
                x: 178.69748010894065,
                y: 313.3107247292978,
            },
            Coord {
                x: 91.47746829048103,
                y: 360.79965086361875,
            },
            Coord {
                x: 91.50558129979011,
                y: 359.2500343818318,
            },
            Coord {
                x: 94.33238284142949,
                y: 356.13256626509633,
            },
            Coord {
                x: 91.61943785201197,
                y: 355.85870231057015,
            },
            Coord {
                x: 162.45878409633931,
                y: 319.40542293651487,
            },
            Coord {
                x: 175.5596215520651,
                y: 305.00719248486604,
            },
            Coord {
                x: 213.481559734292,
                y: 289.176602821379,
            },
            Coord {
                x: 212.24082541367974,
                y: 285.47846008552216,
            },
            Coord {
                x: 208.48923723966695,
                y: 286.23369014455,
            },
            Coord {
                x: 207.57515300304166,
                y: 288.20504863551156,
            },
            Coord {
                x: 206.815011642407,
                y: 288.2191843160252,
            },
            Coord {
                x: 206.79761990399714,
                y: 288.2195077348923,
            },
            Coord {
                x: 206.73263552048343,
                y: 288.22071619233367,
            },
            Coord {
                x: 206.69670020700084,
                y: 288.2213844497616,
            },
            Coord {
                x: 200.38308697914755,
                y: 288.338793163584,
            },
            Coord {
                x: 200.37329511724553,
                y: 288.3389752542301,
            },
            Coord {
                x: 195.94507795197933,
                y: 287.70516880563525,
            },
            Coord {
                x: 195.94507795197936,
                y: 287.70516880563525,
            },
            Coord {
                x: 177.75137408933563,
                y: 285.1011215329728,
            },
            Coord {
                x: 172.47639728970307,
                y: 284.71995173556473,
            },
            Coord {
                x: 172.37763068066027,
                y: 284.7175565773759,
            },
            Coord {
                x: 203.35149933375834,
                y: 279.95282911519445,
            },
            Coord {
                x: 87.0909970255105,
                y: 274.6019377637631,
            },
            Coord {
                x: 0.0,
                y: 291.1811710503077,
            },
            Coord {
                x: 1.1448520206537763e-14,
                y: 275.9029490745503,
            },
            Coord {
                x: -2.842170943040401e-14,
                y: 275.9029490745503,
            },
            Coord {
                x: 0.0,
                y: 243.4003107156999,
            },
        ]),
        vec![],
    );
    let pg2 = Polygon::new(
        LineString(vec![
            Coord {
                x: 367.67936762793977,
                y: 302.785219017324,
            },
            Coord {
                x: 400.0,
                y: 330.3364189888756,
            },
            Coord {
                x: 400.0,
                y: 85.7094729663055,
            },
            Coord {
                x: 375.530089594595,
                y: 124.2204839556052,
            },
            Coord {
                x: 374.98659859747573,
                y: 100.58888400844128,
            },
            Coord {
                x: 375.3219047536835,
                y: 76.99586322948593,
            },
            Coord {
                x: 352.116978342238,
                y: 128.0069901264593,
            },
            Coord {
                x: 296.8607072090515,
                y: 129.49256607782735,
            },
            Coord {
                x: 266.8397653781389,
                y: 154.40474480753,
            },
            Coord {
                x: 259.2004570591687,
                y: 144.14650678216447,
            },
            Coord {
                x: 247.73005601682144,
                y: 120.74050514867251,
            },
            Coord {
                x: 219.9183226476331,
                y: 53.89398800789357,
            },
            Coord {
                x: 214.79766598486256,
                y: 58.54396880088095,
            },
            Coord {
                x: 205.3180727584858,
                y: 37.66458141235276,
            },
            Coord {
                x: 204.9384743502853,
                y: 42.52909575499811,
            },
            Coord {
                x: 198.598592783954,
                y: 39.913773753454365,
            },
            Coord {
                x: 227.5571963507852,
                y: 98.78793110381741,
            },
            Coord {
                x: 211.8877775129764,
                y: 95.80693442569219,
            },
            Coord {
                x: 184.82983774975878,
                y: 111.82526107380869,
            },
            Coord {
                x: 157.3407287714804,
                y: 79.95610899189123,
            },
            Coord {
                x: 146.98556814305613,
                y: 90.1306295921712,
            },
            Coord {
                x: 142.86571296028092,
                y: 103.2131667249273,
            },
            Coord {
                x: 137.06964785547663,
                y: 97.97823184186473,
            },
            Coord {
                x: 133.11594113032265,
                y: 121.5727268145846,
            },
            Coord {
                x: 121.48741956113471,
                y: 112.97229086146046,
            },
            Coord {
                x: 121.26181604684658,
                y: 113.86710164957617,
            },
            Coord {
                x: 235.63037504441513,
                y: 197.77142864845837,
            },
            Coord {
                x: 222.76475236003864,
                y: 233.7471699986308,
            },
            Coord {
                x: 215.48785333121916,
                y: 232.73364849354883,
            },
            Coord {
                x: 177.32511967843928,
                y: 245.4303896678587,
            },
            Coord {
                x: 96.36950989237457,
                y: 246.12195328963338,
            },
            Coord {
                x: 96.33638429757961,
                y: 248.20750628598208,
            },
            Coord {
                x: 66.27444465680952,
                y: 250.87823764635957,
            },
            Coord {
                x: 5.684341886080802e-14,
                y: 252.7246858385403,
            },
            Coord {
                x: 0.0,
                y: 287.00851453579764,
            },
            Coord {
                x: 87.0909970255105,
                y: 274.6019377637631,
            },
            Coord {
                x: 203.35149933375834,
                y: 279.95282911519445,
            },
            Coord {
                x: 186.21553206604779,
                y: 286.312588294279,
            },
            Coord {
                x: 200.37329511724553,
                y: 288.3389752542301,
            },
            Coord {
                x: 204.07584923592933,
                y: 288.2701221108328,
            },
            Coord {
                x: 208.48923723966695,
                y: 286.23369014455,
            },
            Coord {
                x: 212.24082541367974,
                y: 285.47846008552216,
            },
            Coord {
                x: 213.481559734292,
                y: 289.176602821379,
            },
            Coord {
                x: 168.6386654992429,
                y: 312.61353982953256,
            },
            Coord {
                x: 162.45878409633931,
                y: 319.40542293651487,
            },
            Coord {
                x: 93.1525434103433,
                y: 357.43372298059234,
            },
            Coord {
                x: 91.50558129979011,
                y: 359.2500343818318,
            },
            Coord {
                x: 91.43334419528333,
                y: 363.2318140095328,
            },
            Coord {
                x: 178.69748010894065,
                y: 313.3107247292978,
            },
            Coord {
                x: 201.68701198375604,
                y: 314.2277627894801,
            },
            Coord {
                x: 217.6731029946546,
                y: 302.77563506887896,
            },
            Coord {
                x: 221.61838827018173,
                y: 313.1570930513446,
            },
            Coord {
                x: 221.67982343202226,
                y: 315.355350903515,
            },
            Coord {
                x: 243.8528456455854,
                y: 299.9323675588228,
            },
            Coord {
                x: 367.67936762793977,
                y: 302.785219017324,
            },
        ]),
        vec![],
    );

    let _valid_result = Polygon::union(&pg1, &pg2).unwrap();
}

#[test]
fn no_913_intersection_and_difference_for_f32_v2() {
    let p1: MultiPolygon<f32> = MultiPolygon::new(vec![Polygon::new(
        LineString::from(vec![
            Coord {
                x: 142.501_43,
                y: 61.443_245,
            },
            Coord {
                x: 142.056_63,
                y: 61.549_75,
            },
            Coord {
                x: 140.072_56,
                y: 62.337_814,
            },
            Coord {
                x: 142.501_43,
                y: 61.443_245,
            },
        ]),
        vec![],
    )]);
    let p2: MultiPolygon<f32> = MultiPolygon::new(vec![Polygon::new(
        LineString::from(vec![
            Coord {
                x: 140.503_59,
                y: 62.237_686,
            },
            Coord {
                x: 140.072_56,
                y: 62.337_814,
            },
            Coord {
                x: 136.939_97,
                y: 63.053_394,
            },
            Coord {
                x: 140.503_59,
                y: 62.237_686,
            },
        ]),
        vec![],
    )]);

    let intersection = MultiPolygon::intersection(&p1, &p2).unwrap();
    let _valid_result = MultiPolygon::difference(&p1, &intersection).unwrap();
}

#[test]
fn no_913_union_for_f64_simple_triangles() {
    let poly1: Polygon = Polygon::try_from_wkt_str("POLYGON((204.0 287.0,206.69670020700084 288.2213844497616,200.38308697914755 288.338793163584,204.0 287.0))").unwrap();
    let poly2: Polygon = Polygon::try_from_wkt_str("POLYGON((210.0 290.0,204.07584923592933 288.2701221108328,212.24082541367974 285.47846008552216,210.0 290.0))").unwrap();

    let _valid_result = Polygon::union(&poly1, &poly2).unwrap();
}
